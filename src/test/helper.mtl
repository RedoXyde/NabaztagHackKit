//----- asserts
fun test name=
  SLecholn "\n"::name::": "::nil
;;

fun ok should=
  SLecholn "  "::should::" is valid"::nil
;;

fun failed should is=
  SLecholn "!! "::"  "::should::" expected but got "::is::nil
;;

fun assert_equal should=
  if(should == 1) then
    ok ""
  else
    failed "true" "false"
;;

fun assert_not_equal should=
  if(should != 1) then
    ok ""
  else
    failed "false" "true"
;;

fun assert_equalI should is=
  if(should == is) then
    ok itoa should
  else
    failed itoa should itoa is
;;

fun assert_equalS should is=
  let strcat should "\v" -> shouldn in
  if(strcmp shouldn is) then
    ok should
  else
    failed should is
;;

fun assert_equalIL should is=
  if(ILcmp should is) then
    ok listtostr should
  else
    failed listtostr should listtostr is
;;